SvxLink Monitoring Telegram Bot

Разрабатываемый комплекс предназначен для упрощения наблюдения за работой линк-узла, построенного на основе SvxLink и для оперативного оповещения администратора линка при возникновении нештатных ситуаций в его работе. Его работа основывается на анализе текстовых строк вывода SvxLink.
После запуска бот управляется командами из клиента Telegram.

Для управления ботом отправляйте следующие команды:
/svx_start - для запуска SvxLink
/svx_stop - для остановки SvxLink
/svx_status - для запроса состояния SvxLink
/edit_options - для изменения параметров работы бота
/edit_commands - для изменения команд
/settings_status - для просмотра текущих настроек
/add_shortcut - для добавления короткой ссылки
/edit_shortcut - для изменения короткой ссылки
/del_shortcut - для удаления короткой ссылки
/shortcut_status - для просмотра сформированных коротких ссылок
/cancel - для отмены текущей операции (прерывает ожидание ботом ответа пользователя)
/help - короткая справка

SvxLink поддерживает команды, содержащие символы "*", "#", "D", "S", "Q", "p" и цифры от 0 до 9.
Символы "*", "#", "D", 0-9 являются аналогами DTMF-сигналов, используемых для управления линком через радиоэфир, и передаются непосредственно на вход SvxLink.
Символ "Q" служит командой на завершение работы SvxLink и может использоваться в командах, передаваемых ботом SvxLink по событиям и описываемых в конфигурационном файле.
Символ "p" служит для указания необходимости сделать паузу при передаче команды SvxLink. Один знак "p" приостанавливает передачу символов команды на 1 секунду. Применение не ограничивается.
Пример.
Команда 981#pppD3# согласно настройкам SvxLink скоммутирует линк-секцию и после паузы в 3 секунды запустит макрокоманду 3.
Символ "S" служит командой для запуска SvxLink и может использоваться в командах, передаваемых ботом SvxLink по событиям и описываемых в конфигурационном файле. Должен передаваться один в строке и только при незапущенном SvxLink. Во всех иных случаях он игнорируется.

Отслеживание "залипаний" на приём и передачу проводится по всем обнаруженным в ходе работы скрипта каналам логик трансиверов. При обнаружении "залипания" выдаётся тревожное сообщение пользователю и выполняется настроенная в конфигурации команда.

Конфигурационный файл "svxmon_settings.cfg" должен находиться в одном каталоге со скриптом. В противном случае скрипт не запустится.

Описание опций конфигурационного файла.

[Settings] - Секция настроек.
token = в это поле помещается токен созданного бота, полученный у бота-отца @BotFather.
chid = в это поле помещается идентификатор пользователя, полученный у бота @MyTelegramID_bot.
svxpath = путь для запуска SvxLink (в описании пути требуется указывать двойной слеш).

[Options] - Секция изменяемых опций.
svxautostart = стартовать ли SvxLink сразу после запуска бота (True|False).
show_alarm_messages = отправлять тревожные сообщения об ошибках в работе линка (True|False).
show_info_messages = отправлять информационные сообщения об основных событиях (True|False).
show_extinfo_messages = отправлять сообщения с избыточной информацией о событиях (True|False).
tx_stucktout = таймаут, по истечении которого трансивер линка считается "залипшим" на передачу (сек.) Например, 300 (5 минут).
rx_stucktout = таймаут, по истечении которого трансивер линка считается "залипшим" на приём (сек.)

[Commands] - Секция команд.
with_svx_start = команда, передаваемая SvxLink при его запуске. Например, 981#pppppD2#. Если выполнение команды не требуется, оставьте поле пустым.
with_tx_stuck = команда, передаваемая SvxLink при "залипании" на передачу. Например, Q. Если выполнение команды не требуется, оставьте поле пустым.
with_tx_unstuck = команда, передаваемая SvxLink при "отлипании" на передачу. Если выполнение команды не требуется, оставьте поле пустым.
with_rx_stuck = команда, передаваемая SvxLink при "залипании" на приём. Если выполнение команды не требуется, оставьте поле пустым.
with_rx_unstuck = команда, передаваемая SvxLink при "отлипании" на приём. Если выполнение команды не требуется, оставьте поле пустым.

[Shortcuts] - Секция коротких ссылок
Часто подаваемые линку команды можно оформить в виде коротких ссылок для оперативного доступа к ним.
Имя короткой ссылки может содержать буквы a-z, цифры 0-9 и знак подчёркивания. Формат короткой ссылки - "shortcut_name = command".
Пример:
to_russia = 2#ppp196189#

Параметры, описанные в секциях [Options], [Commands] и [Shortcuts] доступны для изменения из клиента Telegram при помощи соответствующих команд. Изменения вступают в силу немедленно.
